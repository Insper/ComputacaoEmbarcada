<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
      
        <title>Lab - 5s - Computação Embarcada</title>
      
    
    <link rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Fira+Sans+Extra+Condensed:700|Oxygen+Mono|Source+Sans+Pro:700|Source+Serif+Pro&amp;display=swap">
    <link rel="stylesheet" href="../../../../assets/css/main.css">
    <script>
      // SETUP GLOBAL CONSTANTS
      var base_url = '../../../..';
      
      var telemetryEnabled = true;
      var backendUrl = "http://localhost:8080/api/";
      var courseSlug = "22b Embarcados";
      
      
      var dashboardEnabled = false;
      var tagTree = {};
      

      // SETUP PLUGIN
      window.initialized = false;
      if (!window.initializers) window.initializers = [];
      window.registerInitializer = (initialize) => {
        if (window.initialized) initialize();
        else window.initializers.push(initialize);
      };
    </script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true
        }
      });
    </script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="https://unpkg.com/hyperscript.org"></script>
    <script src="https://unpkg.com/htmx.org@1.8.4"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="../../../../assets/js/main.js"></script>
    
    
   <link href="../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }</style> <script src="../../../../assets/javascripts/glightbox.min.js"></script></head>
  <body>
    <div class="ah-main-container">
      <header class="ah-header">
        <button class="ah-menu-btn ah-button ah-button--borderless"
                aria-label="toggle menu">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
  <!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
  <path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/>
</svg>
        </button>
        <a href="../../../.."
           title="5s - Computação Embarcada"
           class="ah-logo"
           aria-label="5s - Computação Embarcada">
          5s - Computação Embarcada
        </a>
        <div class="ah-header--right">
          
          
          
          <button id="resetHandoutButton">
            <span class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
  <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"/>
</svg></span>
          </button>
          

          
          <div id="user-menu" hx-get="http://localhost:8080/api/user-menu" hx-trigger="load"> </div>
          
        </div>
      </header>
      <nav class="ah-navigation preload">
        <div class="ah-nav-container">
          <button class="ah-menu-btn ah-button ah-button--borderless close-menu"
                  aria-label="close menu">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512">
  <!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
  <path d="M310.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L160 210.7 54.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L114.7 256 9.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 301.3 265.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L205.3 256 310.6 150.6z"/>
</svg>
          </button>
          <ul class="ah-nav-body">
            
              
  
    <li>
      <a href="../../../..">Home</a>
    </li>
  

            
              
  
    <li>
      <a href="../../../../Sobre-Curso/">Sobre o curso</a>
    </li>
  

            
              
  
    <li>
      <a href="https://github.com/Insper/SAME70-examples">SAME70-Examples</a>
    </li>
  

            
              
  
    <li>
      <a href="../../../Videos/Util-Videos/">Vídeos</a>
    </li>
  

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Util</span>
    <ul>
      
        
  
    <li>
      <a href="../../../Util/Util-Notas/">Notas</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../Util/Sobre-Ferramental/">Ferramental</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../Util/Util-Startup/">Bring up</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../Util/Util-Erros/">Erros comum</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../Util/Util-Documentos/">Manuais</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../Dicas/Util-lcd/">LCD max Touch</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../Dicas/Util-freertos/">Freertos</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../Dicas/Util-FloatPrint/">Float Point (SAM)</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../Dicas/Util-lvgl/">LVGL</a>
    </li>
  

      
    </ul>
  </li>

            
              
  <li class="ah-togglable-item opened">
    <span class="ah-togglable-handle">Labs</span>
    <ul>
      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Lab 1 - PIO </span>
    <ul>
      
        
  
    <li>
      <a href="../../Lab_PIO/Lab-PIO-Teoria/">Teoria</a>
    </li>
  

      
        
  
    <li>
      <a href="../../Lab_PIO/Lab-PIO/">Lab</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../Dicas/Lab-PIO-Dicas/">Dicas</a>
    </li>
  

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item opened">
    <span class="ah-togglable-handle">Lab 2 - PIO - Driver</span>
    <ul>
      
        
  
    <li>
      <a href="../Lab_PIO_DRIVER-Teoria/">Teoria</a>
    </li>
  

      
        
  

    <li class="active ah-togglable-item opened">
      <span class="ah-togglable-handle">Lab</span>
      <ul>
        
          
            
            
              <li class="ah-toc-item">
                <a href="#entrega">Entrega</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#driver">Driver</a>
              </li>
            
        
      </ul>
    </li>
  

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Lab 3 - PIO - IRQ</span>
    <ul>
      
        
  
    <li>
      <a href="../../Lab_PIO_IRQ/Lab-PIO-IRQ-Teoria/">Teoria</a>
    </li>
  

      
        
  
    <li>
      <a href="../../Lab_PIO_IRQ/Lab-PIO-IRQ/">Lab - Parte 1</a>
    </li>
  

      
        
  
    <li>
      <a href="../../Lab_PIO_IRQ/Lab-PIO-IRQ-pratica/">Lab - Parte 2</a>
    </li>
  

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Lab 4 - RTOS</span>
    <ul>
      
        
  
    <li>
      <a href="../../Lab_RTOS/Lab-RTOS/">Lab</a>
    </li>
  

      
        
  
    <li>
      <a href="../../Lab_RTOS/Teoria/">Teoria</a>
    </li>
  

      
    </ul>
  </li>

      
        
  
    <li>
      <a href="../../Lab_RTOS_HCSR04/Lab_RTOS_HCSR04/">Lab 5 - RTOS HC-SR04</a>
    </li>
  

      
        
  
    <li>
      <a href="../../Lab_RTOS_IMU/Lab_RTOS_IMU/">Lab 6 - RTOS IMU</a>
    </li>
  

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Lab 7 - RTOS - LCD - LVGL</span>
    <ul>
      
        
  
    <li>
      <a href="../../Lab_RTOS_LCD_LVGL/Lab-RTOS-LCD-LVGL-START/">Lab RTOS LCD LVGL START</a>
    </li>
  

      
        
  
    <li>
      <a href="../../Lab_RTOS_LCD_LVGL/Lab-RTOS-LCD-LVGL-LAB/">Lab RTOS LCD LVGL LAB</a>
    </li>
  

      
        
  
    <li>
      <a href="../../Lab_RTOS_LCD_LVGL/Lab-RTOS-LCD-LVGL-LAB2/">Lab RTOS LCD LVGL LAB2</a>
    </li>
  

      
    </ul>
  </li>

      
        
  
    <li>
      <a href="../../Lab_TC_RTC_RTT/Lab-TC-RTC-RTT/">Lab 8 - TC - RTC - RTT</a>
    </li>
  

      
        
  
    <li>
      <a href="../../Lab_RTOS_MUTEX/Lab_RTOS_MUTEX/">Lab 9 - RTOS - Mutex</a>
    </li>
  

      
        
  
    <li>
      <a href="../../Lab_RTOS_WIFI/Lab-RTOS-WIFI/">Lab 10 - WIFI</a>
    </li>
  

      
    </ul>
  </li>

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Labs extras</span>
    <ul>
      
        
  
    <li>
      <a href="../../Lab_RTOS_ADC/Lab-RTOS-ADC/">RTOS - ADC</a>
    </li>
  

      
        
  
    <li>
      <a href="../../Lab_ECG/Lab-ECG/">ECG</a>
    </li>
  

      
        
  
    <li>
      <a href="../../Lab_ADC_FIR/Lab-ADC-FIR/">Lab ADC FIR</a>
    </li>
  

      
        
  
    <li>
      <a href="../../Lab_RTOS_UART/Lab-RTOS-UART/">Lab RTOS UART</a>
    </li>
  

      
    </ul>
  </li>

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Projeto</span>
    <ul>
      
        
  
    <li>
      <a href="../../../Projeto/Projeto-1-Descricao/">Descrição</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../Projeto/Projeto-1-Dispositivos/">Dispositivos</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../Projeto/Projeto-1-Entrega1/">Entrega 1</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../Projeto/Projeto-1-Entrega3/">Entrega 2</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../Projeto/Projeto-1-Dicas/">Dicas</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../Projeto/vjoy/">Vjoy</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../Projeto/Projeto-1-Lista/">Anteriores</a>
    </li>
  

      
    </ul>
  </li>

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">APS</span>
    <ul>
      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">APS 1 - Musical</span>
    <ul>
      
        
  
    <li>
      <a href="../../../APS/APS-1-Musical/">Descritivo</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../APS/APS-1-Musical-software/">Firmware</a>
    </li>
  

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">APS 2 - Ciclocomputador</span>
    <ul>
      
        
  
    <li>
      <a href="../../../APS/APS-2-Bike/Descricao/">Descricao</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../APS/APS-2-Bike/Design/">Design</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../APS/APS-2-Bike/Engenharia/">Engenharia</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../APS/APS-2-Bike/Rubrica/">Rubrica</a>
    </li>
  

      
    </ul>
  </li>

      
    </ul>
  </li>

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Avaliações e Simulados</span>
    <ul>
      
        
  
    <li>
      <a href="../../../Avaliacoes_e_Simulados/Avaliacoes/">Avaliação síncrona</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../Prova_assincrona/">Avaliação assíncrona</a>
    </li>
  

      
    </ul>
  </li>

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Code quality</span>
    <ul>
      
        
  
    <li>
      <a href="../../../CodeQuality/topview/">Visão geral</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../CodeQuality/rules/">Regras</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../CodeQuality/cppcheck/">Cppcheck</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../CodeQuality/variables/">Variáveis</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../CodeQuality/head-file/">Head File</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../CodeQuality/isr-variables/">ISR - variáveis</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../CodeQuality/isr-handler/">ISR - handler</a>
    </li>
  

      
    </ul>
  </li>

            
          </ul>
        </div>
      </nav>
      <main class="ah-content ah-typeset">
        
          <div class="ah-title-box">
            <ul class="ah-breadcrumbs">
              
                
                  
                    <li>Labs</li>
                  
                
                  
                    <li>Lab 2 - PIO - Driver</li>
                  
                
                <li></li>
            </ul>
            
            
          </div>
          
            <section class="progress-section show">
<h1 id="lab-pio-driver">LAB - PIO - DRIVER</h1>
<table>
<thead>
<tr>
<th>Lab 2</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Data limite para entrega</strong>: <mark>28/08/2023</mark></td>
</tr>
<tr>
<td>Usar o repositório do <mark><a href="https://classroom.github.com/a/4SaxPGpR">Classroom</a></mark></td>
</tr>
<tr>
<td>Preencher o <mark><a href="https://docs.google.com/forms/d/e/1FAIpQLSen3YNQLkLTwOyIrDlb9rFiedmzGJT__-PMCz56R_zIsXVGxg/viewform?usp=sf_link">forms</a></mark></td>
</tr>
</tbody>
</table>
<h2 id="entrega">Entrega</h2>
<p>O objetivo desse laboratório é o do entendimento das funções utilizadas para configurar o PIO. Como um pino é configurado como saída e entrada? Como o firmware manipula o periférico PIO? Entender o que o PIO é capaz de fazer. Para isso iremos aqui implementar nossas próprias funções de interface com o PIO.</p>
<p>Ao final do lab, deverão ter implementado as seguintes funções:</p>
<ul>
<li>C:<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <code>_pio_set(...)</code></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <code>_pio_clear(...)</code></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <code>_pio_pull_up(...)</code></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <code>_pio_set_input(...)</code></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <code>_pio_set_output(...)</code></li>
</ul>
</li>
<li>B:<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <code>_pio_get(...)</code></li>
</ul>
</li>
<li>A:<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> <code>_delay_ms(...)</code></li>
</ul>
</li>
</ul>
<h2 id="driver">Driver</h2>
<p>Vamos implementar uma série de funções que irão configurar o periférico PIO via a escrita em seu banco de registradores. Para isso será necessário ler o manual do uC mais especificamente a <a href="https://raw.githubusercontent.com/Insper/ComputacaoEmbarcada/master/Manuais/SAME70.pdf">secção do PIO - pág. 344</a>.</p>
<div>
<div class="ah-progress-container"><button class="ah-button ah-button--primary progress" id="prog-0"> Progress </button></div>
</div>
</section>
<section class="progress-section">
<h3 id="_pio_set">_pio_set(...)</h3>
<p>Iremos começar com essa função que é uma das mais simples. Crie uma função no <code>main.c</code> com a seguinte estrutura:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * \brief Set a high output level on all the PIOs defined in ul_mask.</span>
<span class="cm"> * This has no immediate effects on PIOs that are not output, but the PIO</span>
<span class="cm"> * controller will save the value if they are changed to outputs.</span>
<span class="cm"> *</span>
<span class="cm"> * \param p_pio Pointer to a PIO instance.</span>
<span class="cm"> * \param ul_mask Bitmask of one or more pin(s) to configure.</span>
<span class="cm"> */</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">_pio_set</span><span class="p">(</span><span class="n">Pio</span><span class="w"> </span><span class="o">*</span><span class="n">p_pio</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">ul_mask</span><span class="p">)</span>
<span class="p">{</span>

<span class="p">}</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Lembre que essa função serve para acionarmos um pino digital quando o mesmo é configurado como output (fazer ele virar <code>3.3V</code>).</p>
</div>
<p>Na primeira etapa iremos substituir a função que a Microchip já nos disponibiliza por uma criada por nós, em todo lugar no código que você faz o uso da função <code>pio_set(...)</code> substitua a chamada por essa recém criada  <code>_pio_set(...)</code>.</p>
<div class="admonition exercise self-progress" data-slug="navigation/Labs/Lab_PIO_DRIVER/Lab_PIO_DRIVER/exercise_1" id="exercise_1_0">
<p class="admonition-title">pio_set</p>
<form class="exercise-form">
<ol>
<li>Crie a função <code>_pio_set()</code></li>
<li>Substitua no código toda ocorrência de <code>pio_set()</code> pela <code>_pio_set()</code>. </li>
<li>Execute o código, <strong>ele não deve funcionar <img alt="‼️" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/203c.svg" title=":bangbang:" />.</strong><ul>
<li>pois agora a função que aciona um pino não está implementada.</li>
</ul>
</li>
</ol>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Submit" value="Mark as done" />
</div>
</form>
</div>
<div>
<div class="ah-progress-container"><button class="ah-button ah-button--primary progress" id="prog-1"> Progress </button></div>
</div>
</section>
<section class="progress-section">
<p>Agora será necessário entender como o PIO controla os pinos e o que deve ser feito para que ele atue sobre o pino como desejamos. A parte da secção do manual que fala sobre o PIO e suas saídas/entradas é a <strong>secção 32</strong> do (<code>manual SAME70</code>), vamos analisar:</p>
<div class="admonition note">
<p class="admonition-title">SAME70-Manual: 32.5.4 Output Control</p>
<p>Texto extraído do manual:</p>
<blockquote>
<p>The level driven on an I/O line can be determined by <strong>writing</strong> in the Set Output Data Register (<strong>PIO_SODR</strong>) and the Clear Output Data Register (PIO_CODR). These write operations, respectively, set and clear the Output Data Status Register (PIO_ODSR), which represents the data driven on the I/O lines**. Writing in PIO_OER and PIO_ODR manages PIO_OSR whether the pin is configured to be controlled by the PIO Controller or assigned to a peripheral function. This enables configuration of the I/O line prior to setting it to be managed by the PIO Controller.</p>
</blockquote>
</div>
<p>Lendo o texto, podemos descobrir que  para termos <code>1</code> (<code>set</code>) no pino devemos escrever no registrador <code>PIO_SODR</code>, no manual tem mais detalhes sobre tudo do PIO. Vamos analisar a documentação especifica deste registrador (<code>SODR</code>):</p>
<p><a class="glightbox" href="../imgs/pio-sodr.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="PIO_SODR" src="../imgs/pio-sodr.png" /></a></p>
<p>Repare que esse registrador é do tipo <strong>write-only</strong> ou seja ele não pode ser lido, somente escrito. Cada bit desse registrador representa um pino, se pegarmos por exemplo o bit 30 desse registrador (pensando no PIOA) estaríamos nos referindo ao <code>PA30</code>, qualquer alteração <strong>ESCRITA</strong> nesse bit influenciará <strong>SOMENTE</strong> esse pino. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Todos os registradores estão listados e explicados no datasheet, de uma olhada na página <strong>362</strong>, a descrição começa ai.</p>
</div>
<p>Agora que já sabemos o que deve ser feito para colocarmos acionarmos um pino (ativar) e considerando que ele já foi configurado como saída podemos escrever a implementação da função:</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">_pio_set</span><span class="p">(</span><span class="n">Pio</span><span class="w"> </span><span class="o">*</span><span class="n">p_pio</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">ul_mask</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">p_pio</span><span class="o">-&gt;</span><span class="n">PIO_SODR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ul_mask</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li><code>*p_pio</code>: é um endereço recebido do tipo Pio, ele indica o endereço de memória na qual o PIO (periférico) em questão está mapeado (vamos ver isso em detalhes).</li>
<li><code>ul_mask</code>: é a máscara na qual iremos aplicar ao registrador que controla os pinos para colocarmos 1 na saída.</li>
</ul>
<p>O que isso significa? Significa que estamos acessando o periférico passado como referência a função (um dos cinco PIO disponíveis no uc: <em>PIOA</em>,  <em>PIOB</em>, <em>PIOC</em>, ...) e estamos aplicando a máscara <code>ul_mask</code> no seu registrador <code>PIO_SODR</code>.</p>
<div class="admonition note">
<p class="admonition-title">Pio type?</p>
<p>O tipo <code>Pio</code> é uma struct alinhada com o endereço de memória do periférico, onde cada 'item' dessa struct representa um endereço da memória do periférico, essa é uma maneira em <code>C</code> de darmos <em>nome</em> a endereços de memória.  Isso já está definido no projeto quando usamos o asf (para facilitar nossa vida):</p>
<p>O <code>PIOA</code> é um struct que aponta para o endereço <code>0x400E0E00</code></p>
<div class="highlight"><pre><span></span><code><span class="cp">#define PIOA ((Pio    *)0x400E0E00U) </span><span class="cm">/**&lt; \brief (PIOA  ) Base Address */</span>
</code></pre></div>
<p>O struct possui a seguinte estrutura:</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<span class="n">__O</span><span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">PIO_PER</span><span class="p">;</span><span class="w">       </span><span class="cm">/**&lt; \brief (Pio Offset: 0x0000) PIO Enable Register */</span>
<span class="n">__O</span><span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">PIO_PDR</span><span class="p">;</span><span class="w">       </span><span class="cm">/**&lt; \brief (Pio Offset: 0x0004) PIO Disable Register */</span>
<span class="n">__I</span><span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">PIO_PSR</span><span class="p">;</span><span class="w">       </span><span class="cm">/**&lt; \brief (Pio Offset: 0x0008) PIO Status Register */</span>
<span class="n">__I</span><span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">Reserved1</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="n">__O</span><span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">PIO_OER</span><span class="p">;</span><span class="w">       </span><span class="cm">/**&lt; \brief (Pio Offset: 0x0010) Output Enable Register */</span>
<span class="n">__O</span><span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">PIO_ODR</span><span class="p">;</span><span class="w">       </span><span class="cm">/**&lt; \brief (Pio Offset: 0x0014) Output Disable Register */</span>
<span class="n">__I</span><span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">PIO_OSR</span><span class="p">;</span><span class="w">       </span><span class="cm">/**&lt; \brief (Pio Offset: 0x0018) Output Status Register */</span>
<span class="n">__I</span><span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">Reserved2</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="n">__O</span><span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">PIO_IFER</span><span class="p">;</span><span class="w">      </span><span class="cm">/**&lt; \brief (Pio Offset: 0x0020) Glitch Input Filter Enable Register */</span>
<span class="n">__O</span><span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">PIO_IFDR</span><span class="p">;</span><span class="w">      </span><span class="cm">/**&lt; \brief (Pio Offset: 0x0024) Glitch Input Filter Disable Register */</span>
</code></pre></div>
<p>Onde: <code>O</code>, <code>I</code> são macros que bloqueiam os endereços para:</p>
<ul>
<li><code>__O</code> : Apenas escrita (output)</li>
<li><code>__I</code> : Apenas Leitura (input)</li>
<li><code>__IO</code> : Leitura e Escrita (input/output)</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="cp">#ifdef __cplusplus</span>
<span class="w">  </span><span class="cp">#define   __I     volatile        </span><span class="cm">/*!&lt; Defines &#39;read only&#39; permissions                 */</span>
<span class="cp">#else</span>
<span class="w">  </span><span class="cp">#define   __I     volatile const  </span><span class="cm">/*!&lt; Defines &#39;read only&#39; permissions                 */</span>
<span class="cp">#endif</span>
<span class="w">  </span><span class="cp">#define   __O     volatile        </span><span class="cm">/*!&lt; Defines &#39;write only&#39; permissions                */</span>
<span class="w">  </span><span class="cp">#define   __IO    volatile        </span><span class="cm">/*!&lt; Defines &#39;read / write&#39; permissions              */</span>
</code></pre></div>
<p>O diagrama a seguir ilustra o que acontece quando fazemos: <code>p_pio-&gt;PIO_SODR = ul_mask;</code></p>
<p><a class="glightbox" href="../imgs/diagrama.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../imgs/diagrama.png" width="500" /></a></p>
</div>
<div class="admonition exercise self-progress" data-slug="navigation/Labs/Lab_PIO_DRIVER/Lab_PIO_DRIVER/exercise_2" id="exercise_2_0">
<p class="admonition-title">Teste</p>
<form class="exercise-form">
<p>A função está pronta, agora precisamos testar. Com a modificação no código faça a gravação do uC e ele deve voltar a piscar o LED quando você aperta o botão. Agora a função implementada possui a mesma funcionalidade daquela fornecida pelo fabricante.</p>
<ul>
<li>Embarque o código e o mesmo deve funcionar normalmente caso a função implementada esteja correta.</li>
</ul>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Submit" value="Mark as done" />
</div>
</form>
</div>
<div>
<div class="ah-progress-container"><button class="ah-button ah-button--primary progress" id="prog-2"> Progress </button></div>
</div>
</section>
<section class="progress-section">
<h3 id="_pio_clear">_pio_clear(...)</h3>
<p>Faça o mesmo para a função clear:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * \brief Set a low output level on all the PIOs defined in ul_mask.</span>
<span class="cm"> * This has no immediate effects on PIOs that are not output, but the PIO</span>
<span class="cm"> * controller will save the value if they are changed to outputs.</span>
<span class="cm"> *</span>
<span class="cm"> * \param p_pio Pointer to a PIO instance.</span>
<span class="cm"> * \param ul_mask Bitmask of one or more pin(s) to configure.</span>
<span class="cm"> */</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">_pio_clear</span><span class="p">(</span><span class="n">Pio</span><span class="w"> </span><span class="o">*</span><span class="n">p_pio</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">ul_mask</span><span class="p">)</span>
<span class="p">{</span>

<span class="p">}</span>
</code></pre></div>
<div class="admonition exercise text short tag-short-text tag-text-exercise editable" data-slug="navigation/Labs/Lab_PIO_DRIVER/Lab_PIO_DRIVER/short_1" id="short_1_0">
<p class="admonition-title">Exercise<button class="editable-button"></button></p>
<form class="exercise-form">
<p>Consultando a secção 32.5.4 do manual do microcontrolador, qual é o registrador que deve ser acessado para colocar zero no pino?</p>
<div class="form-elements">
<input type="text" value="" name="data"/>

<input class="ah-button ah-button--primary" type="submit" value="Submit"/>
</div>
</form>
<div class="admonition answer no-indent">
<p class="admonition-title">Answer</p>
<ul>
<li><code>pio_codr</code></li>
</ul>
<blockquote>
<p>The level driven on an I/O line can be determined by writing in the Set Output Data Register (PIO_SODR) and the
<mark>Clear Output Data Register (PIO_CODR)</mark>. These write operations, respectively, set and clear the Output Data
Status Register (PIO_ODSR), which represents the data driven on the I/O lines. Writing in PIO_OER and
PIO_ODR manages PIO_OSR whether the pin is configured to be controlled by the PIO Controller or assigned to
a peripheral function. This enables configuration of the I/O line prior to setting it to be managed by the PIO
Controller.</p>
</blockquote>
</div>
</div>
<div class="admonition exercise self-progress" data-slug="navigation/Labs/Lab_PIO_DRIVER/Lab_PIO_DRIVER/exercise_3" id="exercise_3_0">
<p class="admonition-title">Modifique e teste</p>
<form class="exercise-form">
<ol>
<li>Crie a função <code>_pio_clear()</code></li>
<li>Substitua no código toda ocorrência de <code>pio_clear</code> por <code>_pio_clear</code></li>
<li>Implemente a função.</li>
<li>Compile, programe e teste</li>
</ol>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Submit" value="Mark as done" />
</div>
</form>
</div>
<div>
<div class="ah-progress-container"><button class="ah-button ah-button--primary progress" id="prog-3"> Progress </button></div>
</div>
</section>
<section class="progress-section">
<h3 id="_pio_pull_up">_pio_pull_up(...)</h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Só continue se a implementação anterior funcionou.</p>
</div>
<p>Vamos implementar uma função que faz a configuração do <code>pullup</code> nos pinos do PIO, esse pullup é utilizado no botão da placa. Para isso declare a função a seguir:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * \brief Configure PIO internal pull-up.</span>
<span class="cm"> *</span>
<span class="cm"> * \param p_pio Pointer to a PIO instance.</span>
<span class="cm"> * \param ul_mask Bitmask of one or more pin(s) to configure.</span>
<span class="cm"> * \param ul_pull_up_enable Indicates if the pin(s) internal pull-up shall be</span>
<span class="cm"> * configured.</span>
<span class="cm"> */</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">_pio_pull_up</span><span class="p">(</span><span class="n">Pio</span><span class="w"> </span><span class="o">*</span><span class="n">p_pio</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">ul_mask</span><span class="p">,</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">ul_pull_up_enable</span><span class="p">){</span>

<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>Essa função recebe o PIO que irá configurar, os pinos que serão configurados e como último parâmetro se o pullup estará ativado (1) ou desativado (0). </p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Leia o manual do PIO, especificamente <strong>a secção 32.5.1</strong>.</p>
</div>
<div class="admonition exercise text short tag-short-text tag-text-exercise editable" data-slug="navigation/Labs/Lab_PIO_DRIVER/Lab_PIO_DRIVER/short_2" id="short_2_0">
<p class="admonition-title">Exercise<button class="editable-button"></button></p>
<form class="exercise-form">
<p>Consultando a secção 32.5.1 do manual do microcontrolador, qual é o registrador que deve ser acessado para ativar o pullup?</p>
<div class="form-elements">
<input type="text" value="" name="data"/>

<input class="ah-button ah-button--primary" type="submit" value="Submit"/>
</div>
</form>
<div class="admonition answer no-indent">
<p class="admonition-title">Answer</p>
<p><code>pio_puer</code></p>
<blockquote>
<p>Each I/O line is designed with an embedded pull-up resistor and an embedded pull-down resistor. <mark>The pull-up
resistor can be enabled or disabled by writing to the Pull-up Enable Register (PIO_PUER)</mark> or Pull-up Disable
Register (PIO_PUDR), respectively.</p>
</blockquote>
<p>Note que a função <code>pio_pull_up</code> via o parâmetro <code>ul_pull_up_enable</code> ativa e desativa o pull-up. Por conta disso você terá que usar os dois registradores: </p>
<ul>
<li><code>pio_puer</code> / <code>pio_pudr</code></li>
</ul>
</div>
</div>
<div class="admonition exercise self-progress" data-slug="navigation/Labs/Lab_PIO_DRIVER/Lab_PIO_DRIVER/exercise_4" id="exercise_4_0">
<p class="admonition-title">Modifique e teste</p>
<form class="exercise-form">
<ol>
<li>Crie a função <code>_pio_pull_up</code></li>
<li>Substitua no código toda ocorrência de <code>pio_pull_up</code> por <code>_pio_pull_up</code>.</li>
<li>Implemente</li>
<li>Compile, programe e Teste</li>
</ol>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Submit" value="Mark as done" />
</div>
</form>
</div>
<div>
<div class="ah-progress-container"><button class="ah-button ah-button--primary progress" id="prog-4"> Progress </button></div>
</div>
</section>
<section class="progress-section">
<h3 id="_pio_set_input">_pio_set_input(...)</h3>
<p>Agora vamos criar uma nova função para configurar um pino como entrada, para isso inclua os seguintes defines que serão utilizados como forma de configuração da função:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/*  Default pin configuration (no attribute). */</span>
<span class="cp">#define _PIO_DEFAULT             (0u &lt;&lt; 0)</span>
<span class="cm">/*  The internal pin pull-up is active. */</span>
<span class="cp">#define _PIO_PULLUP              (1u &lt;&lt; 0)</span>
<span class="cm">/*  The internal glitch filter is active. */</span>
<span class="cp">#define _PIO_DEGLITCH            (1u &lt;&lt; 1)</span>
<span class="cm">/*  The internal debouncing filter is active. */</span>
<span class="cp">#define _PIO_DEBOUNCE            (1u &lt;&lt; 3)</span>
</code></pre></div>
<p>Esses defines serão passados como configuração da função <code>_pio_set_input()</code> no parâmetro <code>ul_attribute</code>. Declare no seu código a seguinte função:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * \brief Configure one or more pin(s) or a PIO controller as inputs.</span>
<span class="cm"> * Optionally, the corresponding internal pull-up(s) and glitch filter(s) can</span>
<span class="cm"> * be enabled.</span>
<span class="cm"> *</span>
<span class="cm"> * \param p_pio Pointer to a PIO instance.</span>
<span class="cm"> * \param ul_mask Bitmask indicating which pin(s) to configure as input(s).</span>
<span class="cm"> * \param ul_attribute PIO attribute(s).</span>
<span class="cm"> */</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">_pio_set_input</span><span class="p">(</span><span class="n">Pio</span><span class="w"> </span><span class="o">*</span><span class="n">p_pio</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">ul_mask</span><span class="p">,</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">ul_attribute</span><span class="p">)</span>
<span class="p">{</span>

<span class="p">}</span>
</code></pre></div>
<p>Para testar essa função substitua o seguinte trecho de código que configura um pino como entrada + o pull-up</p>
<div class="highlight"><pre><span></span><code><span class="n">pio_set_input</span><span class="p">(</span><span class="n">BUT_PIO</span><span class="p">,</span><span class="w"> </span><span class="n">BUT_PIO_IDX_MASK</span><span class="p">,</span><span class="w"> </span><span class="n">_PIO_DEFAULT</span><span class="p">);</span>
<span class="n">_pio_pull_up</span><span class="p">(</span><span class="n">BUT_PIO</span><span class="p">,</span><span class="w"> </span><span class="n">BUT_PIO_IDX_MASK</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</code></pre></div>
<p>Para:</p>
<div class="highlight"><pre><span></span><code><span class="n">_pio_set_input</span><span class="p">(</span><span class="n">BUT_PIO</span><span class="p">,</span><span class="w"> </span><span class="n">BUT_PIO_IDX_MASK</span><span class="p">,</span><span class="w"> </span><span class="n">_PIO_PULLUP</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">_PIO_DEBOUNCE</span><span class="p">);</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Leia o manual do PIO, especificamente <strong>a secção 32.5.9</strong>.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Utilize a função já implementada <code>_pio_pull_up()</code></p>
</div>
<div class="admonition exercise self-progress" data-slug="navigation/Labs/Lab_PIO_DRIVER/Lab_PIO_DRIVER/exercise_5" id="exercise_5_0">
<p class="admonition-title">Modifique e teste</p>
<form class="exercise-form">
<ol>
<li>Crie a função <code>_pio_set_input</code></li>
<li>Substitua no código toda ocorrência de <code>pio_set_input</code> por <code>_pio_set_input</code>.</li>
<li>Implemente</li>
<li>Compile, programe e teste</li>
</ol>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Submit" value="Mark as done" />
</div>
</form>
</div>
<div>
<div class="ah-progress-container"><button class="ah-button ah-button--primary progress" id="prog-5"> Progress </button></div>
</div>
</section>
<section class="progress-section">
<h3 id="_pio_set_output">_pio_set_output(...)</h3>
<p>Na aula passada utilizamos a função <code>pio_set_output</code> para configurarmos que o pino é uma saída. Iremos aqui definir uma nova função chamada de <code>_pio_set_output()</code> que implementa essa função.</p>
<p>Defina no seu código a função a seguir:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * \brief Configure one or more pin(s) of a PIO controller as outputs, with</span>
<span class="cm"> * the given default value. Optionally, the multi-drive feature can be enabled</span>
<span class="cm"> * on the pin(s).</span>
<span class="cm"> *</span>
<span class="cm"> * \param p_pio Pointer to a PIO instance.</span>
<span class="cm"> * \param ul_mask Bitmask indicating which pin(s) to configure.</span>
<span class="cm"> * \param ul_default_level Default level on the pin(s).</span>
<span class="cm"> * \param ul_multidrive_enable Indicates if the pin(s) shall be configured as</span>
<span class="cm"> * open-drain.</span>
<span class="cm"> * \param ul_pull_up_enable Indicates if the pin shall have its pull-up</span>
<span class="cm"> * activated.</span>
<span class="cm"> */</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">_pio_set_output</span><span class="p">(</span><span class="n">Pio</span><span class="w"> </span><span class="o">*</span><span class="n">p_pio</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">ul_mask</span><span class="p">,</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">ul_default_level</span><span class="p">,</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">ul_multidrive_enable</span><span class="p">,</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">ul_pull_up_enable</span><span class="p">)</span>
<span class="p">{</span>

<span class="p">}</span>
</code></pre></div>
<p>Essa função é um pouco mais complexa, e deve executar as seguintes configurações:</p>
<ol>
<li>
<p>Configurar o PIO para controlar o pino</p>
<ul>
<li>secção 32.5.2<blockquote>
<p>When a pin is multiplexed with one or two peripheral functions, the selection is controlled with the Enable Register (PIO_PER) and the Disable Register (PIO_PDR). The Status Register (PIO_PSR) is the result of the set and clear registers and indicates whether the pin is controlled by the corresponding peripheral or by the PIO Controller.</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>Configurar o pino em modo saída</p>
<ul>
<li>secção <code>32.5.4</code></li>
</ul>
</li>
<li>
<p>Definir a saída inicial do pino (<code>1</code> ou <code>0</code>)</p>
<ul>
<li>aqui você pode fazer uso das duas funções recentes implementadas. </li>
</ul>
</li>
<li>
<p>Ativar ou não o multidrive :</p>
<ul>
<li>Leia a secção <code>32.5.6</code></li>
</ul>
</li>
<li>
<p>Ativar ou não o pull-up :</p>
<ul>
<li>utilize a função <code>_pio_pull_up()</code> recém declarada.<blockquote>
<p>Uma vez implementada a função, utilize ela no seu código substituindo a função <code>pio_set_output()</code> por essa função <code>_pio_set_output()</code>. Teste se o LED continua funcionando, se continuar quer dizer que sua função foi executada com sucesso.</p>
</blockquote>
</li>
</ul>
</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Utilize as funções já implementada <code>_pio_set()</code>, <code>_pio_clear()</code>, <code>_pio_pull_up()</code></p>
</div>
<div class="admonition exercise self-progress" data-slug="navigation/Labs/Lab_PIO_DRIVER/Lab_PIO_DRIVER/exercise_6" id="exercise_6_0">
<p class="admonition-title">Modifique e teste</p>
<form class="exercise-form">
<ol>
<li>Crie a função <code>_pio_set_output</code></li>
<li>Substitua no código toda ocorrência de <code>pio_set_output</code> por <code>_pio_set_output</code>.</li>
<li>Implemente</li>
<li>Compile, programe e teste</li>
</ol>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Submit" value="Mark as done" />
</div>
</form>
</div>
<div>
<div class="ah-progress-container"><button class="ah-button ah-button--primary progress" id="prog-6"> Progress </button></div>
</div>
</section>
<section class="progress-section">
<h3 id="conceito-b-_pio_get">Conceito B: _pio_get(...)</h3>
<p>Implemente a função <code>_pio_get()</code>:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * \brief Return 1 if one or more PIOs of the given Pin instance currently have</span>
<span class="cm"> * a high level; otherwise returns 0. This method returns the actual value that</span>
<span class="cm"> * is being read on the pin. To return the supposed output value of a pin, use</span>
<span class="cm"> * pio_get_output_data_status() instead.</span>
<span class="cm"> *</span>
<span class="cm"> * \param p_pio Pointer to a PIO instance.</span>
<span class="cm"> * \param ul_type PIO type.</span>
<span class="cm"> * \param ul_mask Bitmask of one or more pin(s) to configure.</span>
<span class="cm"> *</span>
<span class="cm"> * \retval 1 at least one PIO currently has a high level.</span>
<span class="cm"> * \retval 0 all PIOs have a low level.</span>
<span class="cm"> */</span>
<span class="kt">uint32_t</span><span class="w"> </span><span class="nf">pio_get</span><span class="p">(</span><span class="n">Pio</span><span class="w"> </span><span class="o">*</span><span class="n">p_pio</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">pio_type_t</span><span class="w"> </span><span class="n">ul_type</span><span class="p">,</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">ul_mask</span><span class="p">)</span>
<span class="p">{}</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">ul_type</p>
<ul>
<li><code>PIO_INPUT</code>: quando for para ler uma <code>entrada</code></li>
<li><code>PIO_OUTPUT_0</code>: quando for para ler uma <code>saida</code></li>
</ul>
</div>
<div class="admonition exercise self-progress" data-slug="navigation/Labs/Lab_PIO_DRIVER/Lab_PIO_DRIVER/exercise_7" id="exercise_7_0">
<p class="admonition-title">Tarefa: Modifique e teste</p>
<form class="exercise-form">
<ol>
<li>Crie a função <code>_pio_get()</code></li>
<li>Substitua no código todas as ocorrências de <code>pio_get</code> por <code>_pio_get()</code></li>
<li>Implemente</li>
<li>Compile, programe e teste</li>
</ol>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Submit" value="Mark as done" />
</div>
</form>
</div>
<h3 id="conceito-a-_delay_ms">Conceito A: _delay_ms(...)</h3>
<p>Crie sua Própria função de <code>delay_ms</code></p>
<div class="admonition exercise self-progress" data-slug="navigation/Labs/Lab_PIO_DRIVER/Lab_PIO_DRIVER/exercise_8" id="exercise_8_0">
<p class="admonition-title">Tarefa: Modifique e teste</p>
<form class="exercise-form">
<ol>
<li>Crie a função <code>_delay_ms()</code></li>
<li>Substitua no código todas as ocorrências de <code>delay_ms</code> por <code>_delay_ms()</code></li>
<li>Implemente</li>
<li>Compile, programe e teste</li>
</ol>
<div class="form-elements">
<input type="hidden" name="data" value="OK" />
<input class="ah-button ah-button--primary" type="submit" name="Submit" value="Mark as done" />
</div>
</form>
</div>


</section>
          
        
      </main>
      <footer class="ah-footer ah-typeset">
        <div class="ah-footer-nav">
          
            <a href="../Lab_PIO_DRIVER-Teoria/"
               class="ah-prev"
               title="Teoria">
              <span class="nav-label">Previous</span>
              <span class="nav-title">Teoria</span>
            </a>
          
          
            <a href="../../Lab_PIO_IRQ/Lab-PIO-IRQ-Teoria/"
               class="ah-next"
               title="Teoria">
              <span class="nav-label">Next</span>
              <span class="nav-title">Teoria</span>
            </a>
          
        </div>
      </footer>
    </div>
    
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
  <script>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});</script></body>
</html>